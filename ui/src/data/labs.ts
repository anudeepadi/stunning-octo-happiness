export interface LabTask {
  id: string
  title: string
  hint?: string
}

export interface Lab {
  id: string
  name: string
  description: string
  category: 'web' | 'network' | 'system' | 'crypto' | 'ctf'
  difficulty: 'beginner' | 'intermediate' | 'advanced'
  duration: string
  target: string
  targetUrl?: string
  objectives: string[]
  tasks: LabTask[]
  tools: string[]
  tags: string[]
  flag?: string
}

export const labs: Lab[] = [
  // ============================================================================
  // MODULE 01: FOUNDATIONS LABS
  // ============================================================================
  {
    id: 'linux-basics',
    name: 'Linux Basics',
    description: 'Master Linux fundamentals including file system hierarchy, navigation, and basic commands.',
    category: 'system',
    difficulty: 'beginner',
    duration: '2 hrs',
    target: 'Kali Linux',
    objectives: [
      'Understand the Linux file system hierarchy',
      'Navigate directories and manage files',
      'Understand users, groups, and permissions',
      'Manage processes and services',
    ],
    tasks: [
      { id: 'linux-1', title: 'Explore the Linux file system hierarchy' },
      { id: 'linux-2', title: 'Practice file navigation with cd, ls, pwd' },
      { id: 'linux-3', title: 'Create, copy, move, and delete files' },
      { id: 'linux-4', title: 'Understand and modify file permissions' },
      { id: 'linux-5', title: 'View and manage running processes' },
    ],
    tools: ['bash', 'ls', 'chmod', 'ps', 'top'],
    tags: ['Linux', 'Fundamentals', 'CLI', 'Beginner'],
  },
  {
    id: 'command-line-mastery',
    name: 'Command Line Mastery',
    description: 'Develop advanced command line skills with pipes, redirection, and text processing.',
    category: 'system',
    difficulty: 'beginner',
    duration: '2 hrs',
    target: 'Kali Linux',
    objectives: [
      'Master pipes and redirection operators',
      'Use grep, sed, awk for text processing',
      'Chain commands effectively',
      'Automate tasks with shell scripts',
    ],
    tasks: [
      { id: 'cmd-1', title: 'Practice piping commands together' },
      { id: 'cmd-2', title: 'Use grep to search through files' },
      { id: 'cmd-3', title: 'Filter and transform text with sed' },
      { id: 'cmd-4', title: 'Process data with awk' },
      { id: 'cmd-5', title: 'Write a basic bash script' },
    ],
    tools: ['grep', 'sed', 'awk', 'bash', 'find'],
    tags: ['CLI', 'Bash', 'Text Processing', 'Automation'],
  },
  {
    id: 'networking-fundamentals',
    name: 'Networking Fundamentals',
    description: 'Learn networking concepts including TCP/IP, DNS, HTTP, and network troubleshooting.',
    category: 'network',
    difficulty: 'beginner',
    duration: '3 hrs',
    target: 'Network Tools',
    objectives: [
      'Understand the OSI and TCP/IP models',
      'Learn DNS, HTTP, and common protocols',
      'Use network diagnostic tools',
      'Analyze basic network traffic',
    ],
    tasks: [
      { id: 'net-1', title: 'Use ping to test connectivity' },
      { id: 'net-2', title: 'Analyze DNS lookups with dig/nslookup' },
      { id: 'net-3', title: 'Trace network routes with traceroute' },
      { id: 'net-4', title: 'Capture packets with tcpdump' },
      { id: 'net-5', title: 'Analyze HTTP traffic in Wireshark' },
    ],
    tools: ['ping', 'dig', 'traceroute', 'tcpdump', 'Wireshark'],
    tags: ['Networking', 'TCP/IP', 'DNS', 'HTTP', 'Fundamentals'],
  },
  {
    id: 'security-tools-intro',
    name: 'Security Tools Introduction',
    description: 'Get familiar with essential cybersecurity tools in Kali Linux.',
    category: 'system',
    difficulty: 'beginner',
    duration: '2 hrs',
    target: 'Kali Linux',
    objectives: [
      'Explore Kali Linux tool categories',
      'Learn basic usage of key tools',
      'Understand tool documentation',
      'Practice responsible tool usage',
    ],
    tasks: [
      { id: 'tools-1', title: 'Explore Nmap for network scanning' },
      { id: 'tools-2', title: 'Use Burp Suite for web analysis' },
      { id: 'tools-3', title: 'Try Metasploit framework basics' },
      { id: 'tools-4', title: 'Practice with Wireshark' },
      { id: 'tools-5', title: 'Learn about John the Ripper' },
    ],
    tools: ['Nmap', 'Burp Suite', 'Metasploit', 'Wireshark', 'John'],
    tags: ['Tools', 'Kali', 'Introduction', 'Security'],
  },
  {
    id: 'lab-environment-setup',
    name: 'Lab Environment Setup',
    description: 'Set up and configure your CyberLab environment with Docker containers.',
    category: 'system',
    difficulty: 'beginner',
    duration: '1.5 hrs',
    target: 'Docker',
    objectives: [
      'Understand Docker basics',
      'Start vulnerable applications',
      'Configure network connectivity',
      'Verify lab environment readiness',
    ],
    tasks: [
      { id: 'setup-1', title: 'Start Docker daemon' },
      { id: 'setup-2', title: 'Launch DVWA container' },
      { id: 'setup-3', title: 'Start Juice Shop application' },
      { id: 'setup-4', title: 'Verify all containers are running' },
      { id: 'setup-5', title: 'Test connectivity to targets' },
    ],
    tools: ['Docker', 'docker-compose', 'curl'],
    tags: ['Setup', 'Docker', 'Environment', 'Configuration'],
  },

  // ============================================================================
  // MODULE 02: NETWORK ANALYSIS LABS
  // ============================================================================
  {
    id: 'packet-capture-basics',
    name: 'Packet Capture Basics',
    description: 'Learn to capture and analyze network traffic using tcpdump and Wireshark.',
    category: 'network',
    difficulty: 'beginner',
    duration: '1.5 hrs',
    target: 'Network Interface',
    objectives: [
      'Capture packets with tcpdump',
      'Apply capture filters',
      'Save and read PCAP files',
      'Understand packet structure',
    ],
    tasks: [
      { id: 'pcap-1', title: 'Capture traffic on loopback interface' },
      { id: 'pcap-2', title: 'Apply BPF filters to capture specific traffic' },
      { id: 'pcap-3', title: 'Save capture to file' },
      { id: 'pcap-4', title: 'Open and analyze in Wireshark' },
      { id: 'pcap-5', title: 'Extract protocol information' },
    ],
    tools: ['tcpdump', 'Wireshark', 'tshark'],
    tags: ['Packets', 'Capture', 'Wireshark', 'tcpdump'],
  },
  {
    id: 'traffic-analysis',
    name: 'Traffic Analysis',
    description: 'Analyze network traffic patterns to identify normal and suspicious activity.',
    category: 'network',
    difficulty: 'intermediate',
    duration: '2 hrs',
    target: 'PCAP Files',
    objectives: [
      'Identify traffic patterns',
      'Extract files from network captures',
      'Detect suspicious traffic',
      'Reconstruct network sessions',
    ],
    tasks: [
      { id: 'traffic-1', title: 'Analyze protocol distribution' },
      { id: 'traffic-2', title: 'Follow TCP streams' },
      { id: 'traffic-3', title: 'Extract HTTP objects' },
      { id: 'traffic-4', title: 'Identify port scans' },
      { id: 'traffic-5', title: 'Detect data exfiltration attempts' },
    ],
    tools: ['Wireshark', 'NetworkMiner', 'tshark'],
    tags: ['Traffic', 'Analysis', 'PCAP', 'Detection'],
  },
  {
    id: 'protocol-analysis',
    name: 'Protocol Analysis',
    description: 'Deep dive into common network protocols and their security implications.',
    category: 'network',
    difficulty: 'intermediate',
    duration: '2.5 hrs',
    target: 'Various Protocols',
    objectives: [
      'Analyze HTTP/HTTPS traffic',
      'Understand DNS protocol',
      'Examine SMTP and email protocols',
      'Study FTP and file transfer',
    ],
    tasks: [
      { id: 'proto-1', title: 'Capture and analyze HTTP requests' },
      { id: 'proto-2', title: 'Examine DNS queries and responses' },
      { id: 'proto-3', title: 'Analyze SMTP email transmission' },
      { id: 'proto-4', title: 'Study FTP authentication' },
      { id: 'proto-5', title: 'Compare encrypted vs unencrypted protocols' },
    ],
    tools: ['Wireshark', 'tcpdump', 'NetworkMiner'],
    tags: ['Protocols', 'HTTP', 'DNS', 'Analysis'],
  },
  {
    id: 'network-scanning',
    name: 'Network Scanning',
    description: 'Master Nmap and other scanning tools for network reconnaissance.',
    category: 'network',
    difficulty: 'intermediate',
    duration: '2 hrs',
    target: 'Lab Network',
    objectives: [
      'Perform host discovery',
      'Scan for open ports',
      'Identify services and versions',
      'Run NSE scripts for enumeration',
    ],
    tasks: [
      { id: 'scan-1', title: 'Discover live hosts with ping sweep' },
      { id: 'scan-2', title: 'Perform TCP SYN scan' },
      { id: 'scan-3', title: 'Identify service versions' },
      { id: 'scan-4', title: 'Run vulnerability scanning scripts' },
      { id: 'scan-5', title: 'Generate scan reports' },
    ],
    tools: ['Nmap', 'masscan', 'Zenmap'],
    tags: ['Scanning', 'Nmap', 'Reconnaissance', 'Enumeration'],
  },

  // ============================================================================
  // MODULE 03: WEB SECURITY LABS
  // ============================================================================
  {
    id: 'sql-injection-basic',
    name: 'SQL Injection - Basics',
    description: 'Learn fundamental SQL injection techniques to bypass authentication and extract data.',
    category: 'web',
    difficulty: 'beginner',
    duration: '45 min',
    target: 'DVWA',
    targetUrl: 'http://localhost:8081',
    objectives: [
      'Understand how SQL injection vulnerabilities occur',
      'Bypass login authentication using SQLi',
      'Extract data using UNION-based injection',
      'Identify SQLi vulnerable parameters',
    ],
    tasks: [
      { id: 'sqli-1', title: 'Login to DVWA with default credentials (admin:password)', hint: 'Check the DVWA documentation' },
      { id: 'sqli-2', title: 'Set security level to LOW', hint: 'Look in DVWA Security settings' },
      { id: 'sqli-3', title: 'Navigate to SQL Injection page' },
      { id: 'sqli-4', title: "Use ' OR '1'='1 to bypass authentication", hint: 'Classic SQLi payload' },
      { id: 'sqli-5', title: 'Extract all usernames from the database', hint: 'Use UNION SELECT' },
      { id: 'sqli-6', title: 'Find the admin password hash' },
    ],
    tools: ['Burp Suite', 'sqlmap', 'Browser DevTools'],
    tags: ['SQL Injection', 'OWASP', 'Authentication Bypass', 'DVWA'],
    flag: 'FLAG{sql_1nj3ct10n_m4st3r}',
  },
  {
    id: 'sql-injection-union',
    name: 'SQL Injection - UNION Based',
    description: 'Master UNION-based SQL injection to extract data from multiple tables.',
    category: 'web',
    difficulty: 'intermediate',
    duration: '1 hr',
    target: 'DVWA',
    targetUrl: 'http://localhost:8081',
    objectives: [
      'Determine the number of columns in a query',
      'Use UNION SELECT to combine result sets',
      'Extract data from information_schema',
      'Enumerate database structure',
    ],
    tasks: [
      { id: 'union-1', title: 'Find the number of columns using ORDER BY', hint: 'Increment until error' },
      { id: 'union-2', title: 'Confirm column count with UNION SELECT NULL,...' },
      { id: 'union-3', title: 'Extract database version', hint: '@@version or version()' },
      { id: 'union-4', title: 'List all databases' },
      { id: 'union-5', title: 'List all tables in current database' },
      { id: 'union-6', title: 'Extract data from users table' },
    ],
    tools: ['Burp Suite', 'sqlmap', 'HackBar'],
    tags: ['SQL Injection', 'UNION', 'Data Extraction', 'Database Enumeration'],
    flag: 'FLAG{un10n_b4s3d_pwn3d}',
  },
  {
    id: 'xss-reflected',
    name: 'XSS - Reflected Cross-Site Scripting',
    description: 'Learn to identify and exploit reflected XSS vulnerabilities.',
    category: 'web',
    difficulty: 'beginner',
    duration: '30 min',
    target: 'DVWA',
    targetUrl: 'http://localhost:8081',
    objectives: [
      'Understand how reflected XSS works',
      'Inject JavaScript into URL parameters',
      'Steal cookies via XSS',
      'Bypass basic XSS filters',
    ],
    tasks: [
      { id: 'xss-r-1', title: 'Navigate to XSS (Reflected) page' },
      { id: 'xss-r-2', title: 'Test basic <script>alert(1)</script> payload' },
      { id: 'xss-r-3', title: 'Extract cookies using document.cookie' },
      { id: 'xss-r-4', title: 'Try img tag with onerror handler', hint: '<img src=x onerror=...>' },
      { id: 'xss-r-5', title: 'Create a crafted URL that triggers XSS' },
    ],
    tools: ['Browser DevTools', 'Burp Suite'],
    tags: ['XSS', 'JavaScript', 'Cookie Theft', 'OWASP'],
    flag: 'FLAG{r3fl3ct3d_xss_pwn3d}',
  },
  {
    id: 'command-injection',
    name: 'Command Injection',
    description: 'Exploit command injection vulnerabilities to execute system commands.',
    category: 'web',
    difficulty: 'intermediate',
    duration: '45 min',
    target: 'DVWA',
    targetUrl: 'http://localhost:8081',
    objectives: [
      'Understand command injection vulnerabilities',
      'Chain commands using ; | && ||',
      'Read sensitive files',
      'Achieve remote code execution',
    ],
    tasks: [
      { id: 'cmdi-1', title: 'Navigate to Command Injection page' },
      { id: 'cmdi-2', title: 'Test basic ping command' },
      { id: 'cmdi-3', title: 'Inject ; to chain commands', hint: 'Try 127.0.0.1; whoami' },
      { id: 'cmdi-4', title: 'Read /etc/passwd file' },
      { id: 'cmdi-5', title: 'Try to get a reverse shell', hint: 'Use netcat or bash' },
    ],
    tools: ['netcat', 'Burp Suite', 'Terminal'],
    tags: ['Command Injection', 'RCE', 'System Commands', 'OWASP'],
    flag: 'FLAG{c0mm4nd_1nj3ct10n_pwn3d}',
  },
  {
    id: 'file-upload-vulnerabilities',
    name: 'File Upload Vulnerabilities',
    description: 'Exploit file upload weaknesses to achieve remote code execution.',
    category: 'web',
    difficulty: 'intermediate',
    duration: '1 hr',
    target: 'DVWA',
    targetUrl: 'http://localhost:8081',
    objectives: [
      'Understand file upload vulnerabilities',
      'Bypass extension restrictions',
      'Upload and execute webshells',
      'Exploit MIME type validation',
    ],
    tasks: [
      { id: 'upload-1', title: 'Navigate to File Upload page' },
      { id: 'upload-2', title: 'Upload a PHP webshell' },
      { id: 'upload-3', title: 'Bypass extension filters' },
      { id: 'upload-4', title: 'Locate uploaded file' },
      { id: 'upload-5', title: 'Execute commands through webshell' },
    ],
    tools: ['Burp Suite', 'Weevely', 'PHP'],
    tags: ['File Upload', 'Webshell', 'RCE', 'OWASP'],
    flag: 'FLAG{f1l3_upl04d_pwn3d}',
  },
  {
    id: 'authentication-attacks',
    name: 'Authentication Attacks',
    description: 'Attack authentication mechanisms including brute force and session hijacking.',
    category: 'web',
    difficulty: 'intermediate',
    duration: '1.5 hrs',
    target: 'DVWA',
    targetUrl: 'http://localhost:8081',
    objectives: [
      'Perform brute force attacks',
      'Exploit weak session management',
      'Hijack user sessions',
      'Bypass authentication controls',
    ],
    tasks: [
      { id: 'auth-1', title: 'Brute force login with Hydra' },
      { id: 'auth-2', title: 'Analyze session tokens' },
      { id: 'auth-3', title: 'Perform session fixation attack' },
      { id: 'auth-4', title: 'Test for predictable session IDs' },
      { id: 'auth-5', title: 'Exploit authentication bypass' },
    ],
    tools: ['Hydra', 'Burp Suite', 'Browser DevTools'],
    tags: ['Authentication', 'Brute Force', 'Session', 'OWASP'],
    flag: 'FLAG{4uth_byp4ss_m4st3r}',
  },
  {
    id: 'csrf-attacks',
    name: 'Cross-Site Request Forgery (CSRF)',
    description: 'Exploit CSRF vulnerabilities to perform unauthorized actions.',
    category: 'web',
    difficulty: 'intermediate',
    duration: '1 hr',
    target: 'DVWA',
    targetUrl: 'http://localhost:8081',
    objectives: [
      'Understand CSRF attack mechanism',
      'Craft malicious HTML forms',
      'Bypass CSRF tokens',
      'Chain with XSS for impact',
    ],
    tasks: [
      { id: 'csrf-1', title: 'Identify CSRF-vulnerable endpoint' },
      { id: 'csrf-2', title: 'Create malicious HTML page' },
      { id: 'csrf-3', title: 'Test CSRF attack' },
      { id: 'csrf-4', title: 'Analyze CSRF token implementation' },
      { id: 'csrf-5', title: 'Exploit weak CSRF protection' },
    ],
    tools: ['Burp Suite', 'Browser', 'HTML'],
    tags: ['CSRF', 'OWASP', 'Web', 'Exploitation'],
    flag: 'FLAG{csrf_4tt4ck_pwn3d}',
  },
  {
    id: 'xxe-attacks',
    name: 'XML External Entity (XXE) Injection',
    description: 'Exploit XXE vulnerabilities to read files and perform SSRF.',
    category: 'web',
    difficulty: 'advanced',
    duration: '1.5 hrs',
    target: 'bWAPP',
    targetUrl: 'http://localhost:8082',
    objectives: [
      'Understand XXE attack vectors',
      'Read local files via XXE',
      'Perform SSRF attacks',
      'Extract sensitive data',
    ],
    tasks: [
      { id: 'xxe-1', title: 'Identify XML input points' },
      { id: 'xxe-2', title: 'Inject external entity declaration' },
      { id: 'xxe-3', title: 'Read /etc/passwd file' },
      { id: 'xxe-4', title: 'Perform blind XXE attack' },
      { id: 'xxe-5', title: 'Use XXE for SSRF' },
    ],
    tools: ['Burp Suite', 'XXEinjector'],
    tags: ['XXE', 'XML', 'SSRF', 'OWASP'],
    flag: 'FLAG{xx3_m4st3r_pwn3d}',
  },
  {
    id: 'insecure-deserialization',
    name: 'Insecure Deserialization',
    description: 'Exploit deserialization vulnerabilities for remote code execution.',
    category: 'web',
    difficulty: 'advanced',
    duration: '2 hrs',
    target: 'Various',
    objectives: [
      'Understand serialization concepts',
      'Identify deserialization points',
      'Craft malicious payloads',
      'Achieve RCE through deserialization',
    ],
    tasks: [
      { id: 'deser-1', title: 'Identify serialized data in requests' },
      { id: 'deser-2', title: 'Analyze serialization format' },
      { id: 'deser-3', title: 'Generate malicious payload with ysoserial' },
      { id: 'deser-4', title: 'Test deserialization exploit' },
      { id: 'deser-5', title: 'Achieve remote code execution' },
    ],
    tools: ['ysoserial', 'Burp Suite', 'Java'],
    tags: ['Deserialization', 'RCE', 'Java', 'OWASP'],
    flag: 'FLAG{d3s3r_4tt4ck_pwn3d}',
  },

  // ============================================================================
  // MODULE 02: NETWORK ANALYSIS LABS (continued)
  // ============================================================================
  {
    id: 'packet-crafting-scapy',
    name: 'Packet Crafting with Scapy',
    description: 'Build and analyze custom network packets using Python Scapy library.',
    category: 'network',
    difficulty: 'intermediate',
    duration: '1 hr',
    target: 'localhost',
    objectives: [
      'Understand TCP/IP packet structure',
      'Build packets layer by layer',
      'Send and receive custom packets',
      'Analyze packet responses',
    ],
    tasks: [
      { id: 'scapy-1', title: 'Start Scapy as root' },
      { id: 'scapy-2', title: 'Create and inspect an IP packet' },
      { id: 'scapy-3', title: 'Build a TCP SYN packet' },
      { id: 'scapy-4', title: 'Perform a TCP SYN scan on port 80' },
      { id: 'scapy-5', title: 'Craft an ICMP echo request' },
      { id: 'scapy-6', title: 'Sniff packets on loopback interface' },
    ],
    tools: ['Scapy', 'Python3', 'Wireshark'],
    tags: ['Scapy', 'Packet Crafting', 'TCP/IP', 'Network Analysis'],
  },
  {
    id: 'network-forensics-ctf',
    name: 'Network Forensics CTF',
    description: 'Analyze PCAP files to find hidden flags and evidence.',
    category: 'network',
    difficulty: 'intermediate',
    duration: '1.5 hrs',
    target: 'PCAP Files',
    objectives: [
      'Analyze network captures with Wireshark',
      'Extract credentials from traffic',
      'Reconstruct transferred files',
      'Identify suspicious traffic patterns',
    ],
    tasks: [
      { id: 'forensics-1', title: 'Open challenge1_password.pcap' },
      { id: 'forensics-2', title: 'Find exfiltrated password in HTTP traffic' },
      { id: 'forensics-3', title: 'Analyze DNS tunneling in challenge4_dns_tunnel.pcap' },
      { id: 'forensics-4', title: 'Extract file from FTP traffic' },
      { id: 'forensics-5', title: 'Identify C2 beacon patterns' },
    ],
    tools: ['Wireshark', 'tshark', 'tcpdump', 'NetworkMiner'],
    tags: ['Forensics', 'PCAP', 'Wireshark', 'Traffic Analysis'],
    flag: 'FLAG{p4ck3t_f0r3ns1cs_m4st3r}',
  },
  {
    id: 'mitm-attacks',
    name: 'Man-in-the-Middle Attacks',
    description: 'Learn ARP spoofing and traffic interception in isolated networks.',
    category: 'network',
    difficulty: 'advanced',
    duration: '1.5 hrs',
    target: 'Network Namespace',
    objectives: [
      'Understand ARP protocol and poisoning',
      'Set up MITM position using ARP spoofing',
      'Intercept and analyze traffic',
      'Modify packets in transit',
    ],
    tasks: [
      { id: 'mitm-1', title: 'Start the isolated MITM lab environment' },
      { id: 'mitm-2', title: 'Scan the network to identify hosts' },
      { id: 'mitm-3', title: 'Perform ARP spoofing with ettercap' },
      { id: 'mitm-4', title: 'Capture credentials in transit' },
      { id: 'mitm-5', title: 'DNS spoof a target domain' },
    ],
    tools: ['ettercap', 'arpspoof', 'mitmproxy', 'Wireshark'],
    tags: ['MITM', 'ARP Spoofing', 'Traffic Interception', 'Network'],
  },

  // ============================================================================
  // SYSTEM EXPLOITATION LABS
  // ============================================================================
  {
    id: 'buffer-overflow-basics',
    name: 'Buffer Overflow - Stack Smashing',
    description: 'Exploit stack-based buffer overflows to control program execution.',
    category: 'system',
    difficulty: 'advanced',
    duration: '2 hrs',
    target: 'Custom Server',
    targetUrl: 'nc localhost 9999',
    objectives: [
      'Understand stack memory layout',
      'Find buffer overflow offset',
      'Overwrite return address',
      'Execute shellcode or call functions',
    ],
    tasks: [
      { id: 'bof-1', title: 'Connect to vulnerable server on port 9999' },
      { id: 'bof-2', title: 'Identify the buffer size (64 bytes)' },
      { id: 'bof-3', title: "Find offset to overwrite RIP using pattern_create" },
      { id: 'bof-4', title: 'Note the address of secret_function' },
      { id: 'bof-5', title: 'Craft payload to call secret_function' },
      { id: 'bof-6', title: 'Capture the flag!' },
    ],
    tools: ['gdb', 'pwntools', 'Python', 'netcat'],
    tags: ['Buffer Overflow', 'Binary Exploitation', 'Stack', 'Memory Corruption'],
    flag: 'FLAG{buff3r_0v3rfl0w_m4st3r}',
  },
  {
    id: 'linux-privesc-suid',
    name: 'Linux PrivEsc - SUID Binaries',
    description: 'Escalate privileges by exploiting misconfigured SUID binaries.',
    category: 'system',
    difficulty: 'intermediate',
    duration: '1 hr',
    target: 'Metasploitable2',
    objectives: [
      'Understand SUID permission bit',
      'Find SUID binaries on system',
      'Exploit common SUID misconfigurations',
      'Escalate to root privileges',
    ],
    tasks: [
      { id: 'suid-1', title: 'Find all SUID binaries: find / -perm -4000 2>/dev/null' },
      { id: 'suid-2', title: 'Check GTFOBins for exploitable binaries' },
      { id: 'suid-3', title: 'Exploit a SUID binary to read /etc/shadow' },
      { id: 'suid-4', title: 'Get a root shell using SUID exploit' },
    ],
    tools: ['find', 'GTFOBins', 'Linux CLI'],
    tags: ['Privilege Escalation', 'SUID', 'Linux', 'Post-Exploitation'],
  },
  {
    id: 'metasploit-basics',
    name: 'Metasploit Framework Basics',
    description: 'Learn to use Metasploit for vulnerability scanning and exploitation.',
    category: 'system',
    difficulty: 'intermediate',
    duration: '1.5 hrs',
    target: 'Metasploitable2',
    objectives: [
      'Navigate Metasploit console',
      'Search and select exploits',
      'Configure exploit options',
      'Get a Meterpreter shell',
    ],
    tasks: [
      { id: 'msf-1', title: 'Start msfconsole' },
      { id: 'msf-2', title: 'Search for vsftpd exploits' },
      { id: 'msf-3', title: 'Configure RHOSTS and LHOST' },
      { id: 'msf-4', title: 'Run the exploit and get a shell' },
      { id: 'msf-5', title: 'Use post-exploitation modules' },
    ],
    tools: ['Metasploit', 'msfconsole', 'msfvenom'],
    tags: ['Metasploit', 'Exploitation', 'Meterpreter', 'Framework'],
  },

  // ============================================================================
  // MODULE 04: SYSTEM EXPLOITATION LABS (continued)
  // ============================================================================
  {
    id: 'enumeration-techniques',
    name: 'System Enumeration Techniques',
    description: 'Master enumeration techniques for gathering system and network information.',
    category: 'system',
    difficulty: 'intermediate',
    duration: '2 hrs',
    target: 'Metasploitable2',
    objectives: [
      'Enumerate users and groups',
      'Discover running services',
      'Identify network shares',
      'Gather system configuration',
    ],
    tasks: [
      { id: 'enum-1', title: 'Enumerate users with enum4linux' },
      { id: 'enum-2', title: 'List SMB shares with smbclient' },
      { id: 'enum-3', title: 'Scan for vulnerabilities with Nessus' },
      { id: 'enum-4', title: 'Check for misconfigurations' },
      { id: 'enum-5', title: 'Document findings' },
    ],
    tools: ['enum4linux', 'smbclient', 'Nmap', 'Nessus'],
    tags: ['Enumeration', 'Reconnaissance', 'Information Gathering'],
  },
  {
    id: 'reverse-shells',
    name: 'Reverse Shells and Bind Shells',
    description: 'Learn to create and use reverse and bind shells for remote access.',
    category: 'system',
    difficulty: 'intermediate',
    duration: '1.5 hrs',
    target: 'Lab VMs',
    objectives: [
      'Understand shell types',
      'Create reverse shell payloads',
      'Set up netcat listeners',
      'Upgrade to interactive shells',
    ],
    tasks: [
      { id: 'shell-1', title: 'Create bash reverse shell' },
      { id: 'shell-2', title: 'Use netcat for connections' },
      { id: 'shell-3', title: 'Generate msfvenom payloads' },
      { id: 'shell-4', title: 'Upgrade to TTY shell' },
      { id: 'shell-5', title: 'Practice with different shell types' },
    ],
    tools: ['netcat', 'msfvenom', 'bash', 'Python'],
    tags: ['Shells', 'Reverse Shell', 'Netcat', 'Exploitation'],
  },
  {
    id: 'password-attacks',
    name: 'Password Attacks',
    description: 'Perform various password attacks including brute force and credential stuffing.',
    category: 'system',
    difficulty: 'intermediate',
    duration: '2 hrs',
    target: 'Multiple Services',
    objectives: [
      'Brute force SSH and FTP',
      'Perform credential stuffing',
      'Use password spraying',
      'Crack captured hashes',
    ],
    tasks: [
      { id: 'pass-1', title: 'Brute force SSH with Hydra' },
      { id: 'pass-2', title: 'Attack FTP with Medusa' },
      { id: 'pass-3', title: 'Perform password spraying' },
      { id: 'pass-4', title: 'Test for default credentials' },
      { id: 'pass-5', title: 'Crack extracted hashes' },
    ],
    tools: ['Hydra', 'Medusa', 'CrackMapExec', 'Hashcat'],
    tags: ['Passwords', 'Brute Force', 'Credential Attacks'],
  },
  {
    id: 'post-exploitation',
    name: 'Post-Exploitation Techniques',
    description: 'Master post-exploitation techniques for maintaining access and pivoting.',
    category: 'system',
    difficulty: 'advanced',
    duration: '2.5 hrs',
    target: 'Lab Environment',
    objectives: [
      'Establish persistence mechanisms',
      'Perform lateral movement',
      'Exfiltrate data',
      'Cover tracks',
    ],
    tasks: [
      { id: 'post-1', title: 'Create persistence with cron jobs' },
      { id: 'post-2', title: 'Pivot to internal network' },
      { id: 'post-3', title: 'Extract sensitive files' },
      { id: 'post-4', title: 'Clear log entries' },
      { id: 'post-5', title: 'Set up backdoors' },
    ],
    tools: ['Meterpreter', 'SSH Tunneling', 'Proxychains'],
    tags: ['Post-Exploitation', 'Persistence', 'Lateral Movement'],
  },

  // ============================================================================
  // MODULE 05: CRYPTOGRAPHY LABS
  // ============================================================================
  {
    id: 'encoding-basics',
    name: 'Encoding Basics',
    description: 'Learn common encoding schemes used in web and security contexts.',
    category: 'crypto',
    difficulty: 'beginner',
    duration: '1 hr',
    target: 'CLI Tools',
    objectives: [
      'Understand Base64 encoding',
      'Work with URL encoding',
      'Practice hex encoding',
      'Recognize encoding patterns',
    ],
    tasks: [
      { id: 'enc-1', title: 'Encode and decode Base64 strings' },
      { id: 'enc-2', title: 'URL encode special characters' },
      { id: 'enc-3', title: 'Convert between hex and ASCII' },
      { id: 'enc-4', title: 'Identify encoded data types' },
      { id: 'enc-5', title: 'Chain multiple encodings' },
    ],
    tools: ['base64', 'Python', 'CyberChef'],
    tags: ['Encoding', 'Base64', 'Hex', 'Fundamentals'],
  },
  {
    id: 'classical-ciphers',
    name: 'Classical Ciphers',
    description: 'Study and break classical encryption ciphers.',
    category: 'crypto',
    difficulty: 'beginner',
    duration: '1.5 hrs',
    target: 'Cipher Challenges',
    objectives: [
      'Understand Caesar cipher',
      'Break substitution ciphers',
      'Analyze Vigenère cipher',
      'Use frequency analysis',
    ],
    tasks: [
      { id: 'cipher-1', title: 'Decrypt Caesar cipher' },
      { id: 'cipher-2', title: 'Solve substitution cipher' },
      { id: 'cipher-3', title: 'Break Vigenère with key length analysis' },
      { id: 'cipher-4', title: 'Use frequency analysis tools' },
    ],
    tools: ['Python', 'CyberChef', 'dcode.fr'],
    tags: ['Ciphers', 'Caesar', 'Vigenère', 'Cryptanalysis'],
  },
  {
    id: 'symmetric-encryption',
    name: 'Symmetric Encryption',
    description: 'Learn about symmetric encryption algorithms like AES and DES.',
    category: 'crypto',
    difficulty: 'intermediate',
    duration: '1.5 hrs',
    target: 'OpenSSL',
    objectives: [
      'Understand symmetric encryption',
      'Work with AES encryption',
      'Explore block cipher modes',
      'Implement encryption in Python',
    ],
    tasks: [
      { id: 'sym-1', title: 'Encrypt data with AES using OpenSSL' },
      { id: 'sym-2', title: 'Compare ECB and CBC modes' },
      { id: 'sym-3', title: 'Implement AES in Python' },
      { id: 'sym-4', title: 'Test padding oracle attacks' },
    ],
    tools: ['OpenSSL', 'Python', 'Cryptography Library'],
    tags: ['Encryption', 'AES', 'Symmetric', 'Cryptography'],
  },
  {
    id: 'asymmetric-encryption',
    name: 'Asymmetric Encryption and PKI',
    description: 'Master asymmetric encryption with RSA and understand Public Key Infrastructure.',
    category: 'crypto',
    difficulty: 'intermediate',
    duration: '2 hrs',
    target: 'OpenSSL',
    objectives: [
      'Understand RSA encryption',
      'Generate key pairs',
      'Sign and verify messages',
      'Work with certificates',
    ],
    tasks: [
      { id: 'asym-1', title: 'Generate RSA key pair' },
      { id: 'asym-2', title: 'Encrypt and decrypt with RSA' },
      { id: 'asym-3', title: 'Sign messages with private key' },
      { id: 'asym-4', title: 'Create self-signed certificates' },
      { id: 'asym-5', title: 'Verify certificate chains' },
    ],
    tools: ['OpenSSL', 'Python', 'RSA Tools'],
    tags: ['RSA', 'Asymmetric', 'PKI', 'Certificates'],
  },
  {
    id: 'hashing-algorithms',
    name: 'Hashing Algorithms',
    description: 'Understand cryptographic hash functions and their security properties.',
    category: 'crypto',
    difficulty: 'intermediate',
    duration: '1 hr',
    target: 'CLI Tools',
    objectives: [
      'Learn about MD5, SHA1, SHA256',
      'Understand hash properties',
      'Test collision resistance',
      'Use HMAC for authentication',
    ],
    tasks: [
      { id: 'hash-algo-1', title: 'Generate hashes with different algorithms' },
      { id: 'hash-algo-2', title: 'Verify file integrity with checksums' },
      { id: 'hash-algo-3', title: 'Implement HMAC in Python' },
      { id: 'hash-algo-4', title: 'Demonstrate MD5 collisions' },
    ],
    tools: ['OpenSSL', 'Python', 'hashlib'],
    tags: ['Hashing', 'MD5', 'SHA', 'Integrity'],
  },
  {
    id: 'hash-cracking',
    name: 'Password Hash Cracking',
    description: 'Crack password hashes using various techniques and tools.',
    category: 'crypto',
    difficulty: 'intermediate',
    duration: '1 hr',
    target: 'Hash Files',
    objectives: [
      'Identify hash types',
      'Use dictionary attacks with wordlists',
      'Apply rule-based attacks',
      'Crack MD5, SHA1, and bcrypt hashes',
    ],
    tasks: [
      { id: 'hash-1', title: 'Identify hash type using hash-identifier' },
      { id: 'hash-2', title: 'Crack MD5 hash with john and rockyou.txt' },
      { id: 'hash-3', title: 'Use hashcat with rules' },
      { id: 'hash-4', title: 'Crack shadow file passwords' },
    ],
    tools: ['John the Ripper', 'Hashcat', 'hash-identifier'],
    tags: ['Hash Cracking', 'Passwords', 'John', 'Hashcat'],
  },
  {
    id: 'steganography-images',
    name: 'Image Steganography',
    description: 'Find hidden data concealed within image files.',
    category: 'crypto',
    difficulty: 'beginner',
    duration: '45 min',
    target: 'Image Files',
    objectives: [
      'Understand steganography concepts',
      'Use tools to detect hidden data',
      'Extract hidden messages and files',
      'Analyze image metadata',
    ],
    tasks: [
      { id: 'stego-1', title: 'Check image metadata with exiftool' },
      { id: 'stego-2', title: 'Use strings to find hidden text' },
      { id: 'stego-3', title: 'Extract data with steghide' },
      { id: 'stego-4', title: 'Analyze with binwalk for embedded files' },
    ],
    tools: ['steghide', 'binwalk', 'exiftool', 'strings', 'zsteg'],
    tags: ['Steganography', 'Hidden Data', 'Images', 'CTF'],
  },
  {
    id: 'crypto-attacks',
    name: 'Cryptographic Attacks',
    description: 'Explore common cryptographic attacks and weaknesses.',
    category: 'crypto',
    difficulty: 'advanced',
    duration: '2 hrs',
    target: 'Crypto Challenges',
    objectives: [
      'Understand padding oracle attacks',
      'Exploit weak random number generators',
      'Perform timing attacks',
      'Analyze cryptographic implementations',
    ],
    tasks: [
      { id: 'crypto-att-1', title: 'Execute padding oracle attack' },
      { id: 'crypto-att-2', title: 'Exploit weak PRNG' },
      { id: 'crypto-att-3', title: 'Perform RSA small exponent attack' },
      { id: 'crypto-att-4', title: 'Test for ECB mode weaknesses' },
    ],
    tools: ['Python', 'PyCrypto', 'OpenSSL'],
    tags: ['Cryptography', 'Attacks', 'Vulnerabilities', 'Advanced'],
  },

  // ============================================================================
  // MODULE 06: WIRELESS SECURITY LABS
  // ============================================================================
  {
    id: 'wireless-fundamentals',
    name: 'Wireless Fundamentals',
    description: 'Learn wireless networking basics and 802.11 standards.',
    category: 'network',
    difficulty: 'beginner',
    duration: '1.5 hrs',
    target: 'Wireless Networks',
    objectives: [
      'Understand 802.11 standards',
      'Learn wireless encryption types',
      'Study wireless network architecture',
      'Explore frequency bands and channels',
    ],
    tasks: [
      { id: 'wireless-1', title: 'Study 802.11 a/b/g/n/ac standards' },
      { id: 'wireless-2', title: 'Compare WEP, WPA, WPA2, WPA3' },
      { id: 'wireless-3', title: 'Analyze wireless frames in Wireshark' },
      { id: 'wireless-4', title: 'Understand SSID and BSSID' },
    ],
    tools: ['Wireshark', 'aircrack-ng', 'iwconfig'],
    tags: ['Wireless', '802.11', 'WiFi', 'Fundamentals'],
  },
  {
    id: 'wifi-security-protocols',
    name: 'WiFi Security Protocols',
    description: 'Deep dive into WiFi security mechanisms and their vulnerabilities.',
    category: 'network',
    difficulty: 'intermediate',
    duration: '2 hrs',
    target: 'Wireless Lab',
    objectives: [
      'Understand WPA/WPA2 handshake',
      'Study TKIP and CCMP encryption',
      'Analyze authentication methods',
      'Learn about WPA3 improvements',
    ],
    tasks: [
      { id: 'wifi-sec-1', title: 'Capture 4-way WPA handshake' },
      { id: 'wifi-sec-2', title: 'Analyze EAPOL frames' },
      { id: 'wifi-sec-3', title: 'Compare PSK and Enterprise modes' },
      { id: 'wifi-sec-4', title: 'Study WPA3 SAE handshake' },
    ],
    tools: ['aircrack-ng', 'Wireshark', 'airdump-ng'],
    tags: ['WiFi', 'WPA', 'Security Protocols', 'Encryption'],
  },
  {
    id: 'wireless-reconnaissance',
    name: 'Wireless Reconnaissance',
    description: 'Discover and enumerate wireless networks in your environment.',
    category: 'network',
    difficulty: 'beginner',
    duration: '1 hr',
    target: 'Wireless Networks',
    objectives: [
      'Scan for wireless networks',
      'Identify hidden SSIDs',
      'Enumerate connected clients',
      'Map wireless coverage',
    ],
    tasks: [
      { id: 'wireless-recon-1', title: 'Put wireless card in monitor mode' },
      { id: 'wireless-recon-2', title: 'Scan for networks with airodump-ng' },
      { id: 'wireless-recon-3', title: 'Identify connected clients' },
      { id: 'wireless-recon-4', title: 'Detect hidden networks' },
    ],
    tools: ['aircrack-ng suite', 'kismet', 'inSSIDer'],
    tags: ['Wireless', 'Reconnaissance', 'Scanning', 'Enumeration'],
  },
  {
    id: 'wep-cracking',
    name: 'WEP Cracking',
    description: 'Exploit WEP weaknesses to crack encryption keys.',
    category: 'network',
    difficulty: 'intermediate',
    duration: '1 hr',
    target: 'WEP Network',
    objectives: [
      'Understand WEP vulnerabilities',
      'Capture IVs for cracking',
      'Use packet injection',
      'Crack WEP keys',
    ],
    tasks: [
      { id: 'wep-1', title: 'Capture WEP traffic' },
      { id: 'wep-2', title: 'Inject ARP packets to generate traffic' },
      { id: 'wep-3', title: 'Collect sufficient IVs' },
      { id: 'wep-4', title: 'Crack WEP key with aircrack-ng' },
    ],
    tools: ['aircrack-ng', 'aireplay-ng', 'airodump-ng'],
    tags: ['WEP', 'Cracking', 'Wireless', 'Deprecated'],
  },
  {
    id: 'wpa-attacks',
    name: 'WPA/WPA2 Attacks',
    description: 'Attack WPA/WPA2 networks using handshake capture and dictionary attacks.',
    category: 'network',
    difficulty: 'intermediate',
    duration: '2 hrs',
    target: 'WPA2 Network',
    objectives: [
      'Capture WPA handshakes',
      'Perform deauthentication attacks',
      'Crack WPA with dictionaries',
      'Use GPU acceleration',
    ],
    tasks: [
      { id: 'wpa-1', title: 'Capture WPA 4-way handshake' },
      { id: 'wpa-2', title: 'Verify handshake validity' },
      { id: 'wpa-3', title: 'Crack handshake with aircrack-ng' },
      { id: 'wpa-4', title: 'Use hashcat with GPU' },
    ],
    tools: ['aircrack-ng', 'hashcat', 'hcxtools'],
    tags: ['WPA', 'WPA2', 'Cracking', 'Handshake'],
  },
  {
    id: 'deauth-attacks',
    name: 'Deauthentication Attacks',
    description: 'Perform deauth attacks to disconnect clients and capture handshakes.',
    category: 'network',
    difficulty: 'intermediate',
    duration: '1 hr',
    target: 'Wireless Clients',
    objectives: [
      'Understand deauth frames',
      'Target specific clients',
      'Capture reconnection handshakes',
      'Defend against deauth attacks',
    ],
    tasks: [
      { id: 'deauth-1', title: 'Identify target network and client' },
      { id: 'deauth-2', title: 'Send deauth packets with aireplay-ng' },
      { id: 'deauth-3', title: 'Capture handshake on reconnection' },
      { id: 'deauth-4', title: 'Test deauth defenses (802.11w)' },
    ],
    tools: ['aireplay-ng', 'mdk4', 'airodump-ng'],
    tags: ['Deauthentication', 'DoS', 'Wireless', 'Attack'],
  },
  {
    id: 'evil-twin-attacks',
    name: 'Evil Twin Attacks',
    description: 'Create rogue access points to intercept wireless traffic.',
    category: 'network',
    difficulty: 'advanced',
    duration: '2 hrs',
    target: 'Wireless Lab',
    objectives: [
      'Set up rogue access point',
      'Create captive portal',
      'Capture credentials',
      'Perform MITM attacks',
    ],
    tasks: [
      { id: 'evil-1', title: 'Configure rogue AP with hostapd' },
      { id: 'evil-2', title: 'Create captive portal' },
      { id: 'evil-3', title: 'Deauth clients from legitimate AP' },
      { id: 'evil-4', title: 'Intercept and analyze traffic' },
    ],
    tools: ['hostapd', 'dnsmasq', 'Fluxion', 'WiFi-Pumpkin'],
    tags: ['Evil Twin', 'Rogue AP', 'MITM', 'Wireless'],
  },
  {
    id: 'bluetooth-security',
    name: 'Bluetooth Security',
    description: 'Explore Bluetooth security and attack vectors.',
    category: 'network',
    difficulty: 'intermediate',
    duration: '1.5 hrs',
    target: 'Bluetooth Devices',
    objectives: [
      'Scan for Bluetooth devices',
      'Enumerate services',
      'Test for vulnerabilities',
      'Perform bluejacking and bluesnarfing',
    ],
    tasks: [
      { id: 'bt-1', title: 'Scan for nearby Bluetooth devices' },
      { id: 'bt-2', title: 'Enumerate device services with sdptool' },
      { id: 'bt-3', title: 'Test for BlueBorne vulnerabilities' },
      { id: 'bt-4', title: 'Attempt device pairing' },
    ],
    tools: ['hcitool', 'sdptool', 'bluetoothctl', 'btscanner'],
    tags: ['Bluetooth', 'Wireless', 'BLE', 'IoT'],
  },

  // ============================================================================
  // MODULE 07: ACTIVE DIRECTORY LABS
  // ============================================================================
  {
    id: 'ad-fundamentals',
    name: 'Active Directory Fundamentals',
    description: 'Learn Active Directory architecture, components, and core concepts.',
    category: 'system',
    difficulty: 'intermediate',
    duration: '2 hrs',
    target: 'AD Lab',
    objectives: [
      'Understand AD structure and objects',
      'Learn about domains and forests',
      'Study Group Policy',
      'Explore AD services (LDAP, DNS, Kerberos)',
    ],
    tasks: [
      { id: 'ad-fund-1', title: 'Explore AD structure with PowerShell' },
      { id: 'ad-fund-2', title: 'Query LDAP with ldapsearch' },
      { id: 'ad-fund-3', title: 'Analyze Group Policy Objects' },
      { id: 'ad-fund-4', title: 'Understand domain trusts' },
    ],
    tools: ['PowerShell', 'RSAT', 'ldapsearch'],
    tags: ['Active Directory', 'Fundamentals', 'Windows', 'LDAP'],
  },
  {
    id: 'ad-enumeration',
    name: 'Active Directory Enumeration',
    description: 'Enumerate AD objects, users, groups, and computers.',
    category: 'system',
    difficulty: 'intermediate',
    duration: '2 hrs',
    target: 'AD Lab',
    objectives: [
      'Enumerate users and groups',
      'Discover computers and servers',
      'Find privileged accounts',
      'Map domain trusts',
    ],
    tasks: [
      { id: 'ad-enum-1', title: 'Use BloodHound to map AD' },
      { id: 'ad-enum-2', title: 'Enumerate with PowerView' },
      { id: 'ad-enum-3', title: 'Find users with SPN set (Kerberoastable)' },
      { id: 'ad-enum-4', title: 'Identify domain admins' },
    ],
    tools: ['BloodHound', 'PowerView', 'ldapdomaindump'],
    tags: ['Active Directory', 'Enumeration', 'BloodHound', 'PowerView'],
  },
  {
    id: 'kerberos-attacks',
    name: 'Kerberos Attacks',
    description: 'Exploit Kerberos authentication with Kerberoasting and AS-REP roasting.',
    category: 'system',
    difficulty: 'advanced',
    duration: '2.5 hrs',
    target: 'AD Lab',
    objectives: [
      'Understand Kerberos authentication',
      'Perform Kerberoasting',
      'Execute AS-REP roasting',
      'Crack service tickets',
    ],
    tasks: [
      { id: 'kerb-1', title: 'Request TGT with impacket' },
      { id: 'kerb-2', title: 'Kerberoast accounts with SPNs' },
      { id: 'kerb-3', title: 'AS-REP roast users without preauth' },
      { id: 'kerb-4', title: 'Crack tickets with hashcat' },
      { id: 'kerb-5', title: 'Test for golden/silver ticket attacks' },
    ],
    tools: ['Rubeus', 'impacket', 'hashcat', 'mimikatz'],
    tags: ['Kerberos', 'Kerberoasting', 'AS-REP', 'Tickets'],
  },
  {
    id: 'ad-credential-attacks',
    name: 'AD Credential Attacks',
    description: 'Extract and crack Active Directory credentials.',
    category: 'system',
    difficulty: 'advanced',
    duration: '2 hrs',
    target: 'AD Lab',
    objectives: [
      'Dump credentials with mimikatz',
      'Extract NTDS.dit',
      'Perform DCSync attacks',
      'Crack NTLM hashes',
    ],
    tasks: [
      { id: 'cred-1', title: 'Dump LSASS with mimikatz' },
      { id: 'cred-2', title: 'Extract NTDS.dit from Domain Controller' },
      { id: 'cred-3', title: 'Perform DCSync with impacket' },
      { id: 'cred-4', title: 'Crack NTLM hashes' },
      { id: 'cred-5', title: 'Use Pass-the-Hash attacks' },
    ],
    tools: ['mimikatz', 'impacket', 'hashcat', 'secretsdump'],
    tags: ['Credentials', 'mimikatz', 'NTLM', 'DCSync'],
  },
  {
    id: 'delegation-attacks',
    name: 'Delegation Attacks',
    description: 'Exploit Kerberos delegation for privilege escalation.',
    category: 'system',
    difficulty: 'advanced',
    duration: '2 hrs',
    target: 'AD Lab',
    objectives: [
      'Understand delegation types',
      'Exploit unconstrained delegation',
      'Abuse constrained delegation',
      'Attack resource-based constrained delegation',
    ],
    tasks: [
      { id: 'deleg-1', title: 'Identify accounts with delegation' },
      { id: 'deleg-2', title: 'Exploit unconstrained delegation' },
      { id: 'deleg-3', title: 'S4U2Self and S4U2Proxy attacks' },
      { id: 'deleg-4', title: 'Configure RBCD for privilege escalation' },
    ],
    tools: ['Rubeus', 'PowerView', 'impacket'],
    tags: ['Delegation', 'Kerberos', 'Privilege Escalation', 'AD'],
  },
  {
    id: 'domain-dominance',
    name: 'Domain Dominance',
    description: 'Achieve full domain compromise and domain admin access.',
    category: 'system',
    difficulty: 'advanced',
    duration: '3 hrs',
    target: 'AD Lab',
    objectives: [
      'Escalate to domain admin',
      'Compromise domain controller',
      'Create golden tickets',
      'Establish persistence',
    ],
    tasks: [
      { id: 'dom-1', title: 'Find path to domain admin with BloodHound' },
      { id: 'dom-2', title: 'Exploit ACL abuse for privilege escalation' },
      { id: 'dom-3', title: 'Compromise domain controller' },
      { id: 'dom-4', title: 'Create golden ticket with krbtgt hash' },
      { id: 'dom-5', title: 'Test golden ticket access' },
    ],
    tools: ['BloodHound', 'mimikatz', 'impacket', 'PowerView'],
    tags: ['Domain Admin', 'Domain Controller', 'Golden Ticket', 'Compromise'],
  },
  {
    id: 'ad-persistence',
    name: 'AD Persistence Techniques',
    description: 'Maintain persistent access in Active Directory environments.',
    category: 'system',
    difficulty: 'advanced',
    duration: '2 hrs',
    target: 'AD Lab',
    objectives: [
      'Create backdoor accounts',
      'Establish golden/silver tickets',
      'Implant AD persistence',
      'Use AdminSDHolder abuse',
    ],
    tasks: [
      { id: 'persist-1', title: 'Create hidden admin account' },
      { id: 'persist-2', title: 'Add to AdminSDHolder for persistence' },
      { id: 'persist-3', title: 'Create skeleton key with mimikatz' },
      { id: 'persist-4', title: 'Implant DCShadow for covert operations' },
    ],
    tools: ['mimikatz', 'PowerView', 'Empire'],
    tags: ['Persistence', 'Backdoors', 'Active Directory', 'Stealth'],
  },

  // ============================================================================
  // MODULE 08: CTF CHALLENGES
  // ============================================================================
  {
    id: 'ctf-web-beginner',
    name: 'CTF: Web Challenges (Beginner)',
    description: 'Beginner-level CTF challenges focused on web vulnerabilities.',
    category: 'ctf',
    difficulty: 'beginner',
    duration: '2 hrs',
    target: 'Multiple',
    objectives: [
      'Solve 5 beginner web challenges',
      'Practice SQL injection',
      'Find hidden directories',
      'Exploit weak authentication',
    ],
    tasks: [
      { id: 'ctf-web-1', title: 'Challenge 1: Find the hidden admin page' },
      { id: 'ctf-web-2', title: 'Challenge 2: Bypass login with SQLi' },
      { id: 'ctf-web-3', title: 'Challenge 3: Extract flag from cookies' },
      { id: 'ctf-web-4', title: 'Challenge 4: Directory traversal to read flag' },
      { id: 'ctf-web-5', title: 'Challenge 5: Exploit IDOR vulnerability' },
    ],
    tools: ['Burp Suite', 'dirb', 'Browser DevTools'],
    tags: ['CTF', 'Web', 'Challenges', 'Beginner'],
  },
]
